#!/bin/bash

if [[ `screen -ls | grep -e Custom-MADE ` ]]; then
	screen -ls | grep -e Custom-MADE | cut -d. -f1 | awk '{print $1}' | xargs kill;
fi

# ------------------------------------------------------------
# ------------------------------------------------------------
#   ______       _        ______  ___  ____  ________ ____  _____ ______    
#  |_   _ \     / \     .' ___  ||_  ||_  _||_   __  |_   \|_   _|_   _ `.  
#    | |_) |   / _ \   / .'   \_|  | |_/ /    | |_ \_| |   \ | |   | | `. \ 
#    |  __'.  / ___ \  | |         |  __'.    |  _| _  | |\ \| |   | |  | | 
#   _| |__) |/ /   \ \_\ `.___.'\ _| |  \ \_ _| |__/ |_| |_\   |_ _| |_.' / 
#  |_______/____| |____|`.____ .'|____||____|________|_____|\____|______.'  
#
# ------------------------------------------------------------
# ------------------------------------------------------------
#
# start spring backend 

cd backend
	if [[ $1 == "no-clean" ]]; then
		screen -dmS Custom-MADE-Backend bash -c "mvn compile process-classes exec:java"
	else 
		screen -dmS Custom-MADE-Backend bash -c "mvn clean compile process-classes exec:java"
	fi
cd ..

# ------------------------------------------------------------
# ------------------------------------------------------------
#     ______  ____    ____   ____      ____ ________ ______    
#   .' ___  ||_   \  /   _| |_  _|    |_  _|_   __  |_   _ \   
#  / .'   \_|  |   \/   |     \ \  /\  / /   | |_ \_| | |_) |  
#  | |         | |\  /| |      \ \/  \/ /    |  _| _  |  __'.  
#  \ `.___.'\ _| |_\/_| |_      \  /\  /    _| |__/ |_| |__) | 
#   `.____ .'|_____||_____|      \/  \/    |________|_______/  
#  
# ------------------------------------------------------------
# ------------------------------------------------------------
#


# start the web front-end of Custom-MADE (react app)
cd web-ui
	screen -dmS Custom-MADE-Web-UI bash -c "npm i && npm run start"
cd ..


# ------------------------------------------------------------
# ------------------------------------------------------------
#     ______  ____    ____   ________ ______   _____ _________   ___   _______     
#   .' ___  ||_   \  /   _| |_   __  |_   _ `.|_   _|  _   _  |.'   `.|_   __ \    
#  / .'   \_|  |   \/   |     | |_ \_| | | `. \ | | |_/ | | \_/  .-.  \ | |__) |   
#  | |         | |\  /| |     |  _| _  | |  | | | |     | |   | |   | | |  __ /    
#  \ `.___.'\ _| |_\/_| |_   _| |__/ |_| |_.' /_| |_   _| |_  \  `-'  /_| |  \ \_  
#   `.____ .'|_____||_____| |________|______.'|_____| |_____|  `.___.'|____| |___| 
#
# ------------------------------------------------------------
# ------------------------------------------------------------
#

# start monaco editor employed as LSP Client (language client)
cd editor
	screen -dmS Custom-MADE-Editor bash -c "npm i && npm run start"
cd ..
